"use strict";Object.defineProperties(exports,{t:{value:!0},[Symbol.toStringTag]:{value:"Module"}});class t{constructor(t,s,e,r=t<<16|s<<8|e){this.i=1,this.o=-1,this.h=-1,this.u=-1,this.l=-1,this.M=t,this.g=s,this.p=e,this.m=r}static distance(t,s){return(Math.abs(s.M-t.M)+Math.abs(s.g-t.g)+Math.abs(s.p-t.p))/765}clone(){const s=new t(this.M,this.g,this.p,this.m);return s.i=this.i,s}$(){const t=this.M/255,s=this.g/255,e=this.p/255,r=Math.max(t,s,e),n=Math.min(t,s,e);if(this.u=(r+n)/2,r===n)this.h=0,this.o=0,this.l=0;else{const i=r-n;switch(this.o=this.u>.5?i/(2-r-n):i/(r+n),this.l=this.o*(2*(.5-Math.abs(.5-this.u))),r){case t:this.h=((s-e)/i+(s<e?6:0))/6;break;case s:this.h=((e-t)/i+2)/6;break;case e:this.h=((t-s)/i+4)/6}}}get C(){return-1===this.h&&this.$(),this.h}get v(){return-1===this.o&&this.$(),this.o}get j(){return-1===this.u&&this.$(),this.u}get D(){return-1===this.l&&this.$(),this.l}}const s=(t,s)=>Math.abs(t-s);class e{constructor(){this.N=[],this.S=null}I(t){this.N.push(t),this.S=null}O(t,e,r,n){for(let h=0;h<this.N.length;h++){const a=this.N[h];if(!(i=a.C,o=t.C,Math.min(s(i,o),s((i+.5)%1,(o+.5)%1))<e&&s(a.v,t.v)<r&&s(a.j,t.j)<n))return!1}var i,o;return!0}get _(){if(!this.S){const{r:s,L:e,b:r}=this.N.reduce(((t,s)=>(t.r+=s.M,t.L+=s.g,t.b+=s.p,t)),{r:0,L:0,b:0}),n=this.N.reduce(((t,s)=>t+s.i),0);this.S=new t(Math.round(s/this.N.length),Math.round(e/this.N.length),Math.round(r/this.N.length)),this.S.i=n}return this.S}}class r{constructor(t,s,e){this.P=[],this.C=t,this.v=s,this.j=e}I(t){const s=this.P.find((s=>s.O(t,this.C,this.v,this.j)));if(s)s.I(t);else{const s=new e;s.I(t),this.P.push(s)}}F(){return this.P.map((t=>t._))}}var n=({pixels:t=64e3,distance:s=.22,colorValidator:e=((t,s,e,r)=>(null!=r?r:255)>250),hueDistance:r=.08333333333333333,saturationDistance:n=.2,lightnessDistance:i=.2,crossOrigin:o=null}={})=>{if("production"!==process.env.NODE_ENV){const o=(t,s,e=0,r=Number.MAX_VALUE)=>{if(Number(s)!==s)throw new Error(`${t} is not a valid number (${s})`);return s<e&&console.warn(`${t} can not be less than ${e} (it's ${s})`),s>r&&console.warn(`${t} can not be more than ${r} (it's ${s})`),Math.min(Math.max(s,e),r)},h=(t,s)=>{if(!s||"[object Function]"!=={}.toString.call(s))throw new Error(`${t} is not a function (${s})`);return s};((t,s,e=0,r=Number.MAX_SAFE_INTEGER)=>{if(!Number.isInteger(s))throw new Error(`${t} is not a valid number (${s})`);return s<e&&console.warn(`${t} can not be less than ${e} (it's ${s})`),s>r&&console.warn(`${t} can not be more than ${r} (it's ${s})`),Math.min(Math.max(s,e),r)})("pixels",t||0,1),o("distance",s,0,1),h("colorValidator",e),o("hueDistance",r,0,1),o("saturationDistance",n,0,1),o("lightnessDistance",i,0,1)}return[Math.max(t,1),Math.min(Math.max(s,0),1),e,Math.min(Math.max(r,0),1),Math.min(Math.max(n,0),1),Math.min(Math.max(i,0),1),o]};class i{constructor(){this.i=0,this.k={}}I(s,e,r,n){return this.i++,this.k[s]?this.k[s].i++:this.k[s]=new t(e,r,n,s),this.k[s]}G(){return Object.keys(this.k).map((t=>this.k[t]))}H(){const t=this.G().reduce(((t,s)=>t.i>=s.i?t:s)).clone();return t.i=this.i,t}}class o{constructor(){this.i=0,this.k={}}G(){return Object.keys(this.k).map((t=>this.k[t]))}I(t,s,e){const r=t<<16|s<<8|e,n=(t>>4&15)<<8|(s>>4&15)<<4|e>>4&15;return this.i++,this.V(n).I(r,t,s,e)}V(t){return this.k[t]||(this.k[t]=new i),this.k[t]}T(s){const e=this.G().map((t=>t.H()));e.sort(((t,s)=>s.i-t.i));const r=[];for(;e.length;){const n=e.shift();e.filter((e=>t.distance(n,e)<s)).forEach((t=>{n.i+=t.i;const s=e.findIndex((s=>s===t));e.splice(s,1)})),r.push(n)}return r}}var h=({data:t,width:s,height:e},r,n,i)=>{const h=new o,a=s&&e&&Math.floor(s*e/r)||1;let c=0;for(let o=0;o<t.length;o+=4*a){const s=t[o],e=t[o+1],r=t[o+2];i(s,e,r,t[o+3])?h.I(s,e,r):c++}return{N:h.T(n),count:h.i+c}};const a=()=>"undefined"!=typeof window,c=(t,s,e,n,i)=>{const o=((t,s,e,n,i)=>{const o=new r(e,n,i);t.forEach((t=>o.I(t)));const h=o.F();return h.sort(((t,e)=>(e.D+.1)*(.9-e.i/s)-(t.D+.1)*(.9-t.i/s))),h})(t,s,e,n,i);return o.map((t=>((t,s)=>({hex:`#${"0".repeat(6-t.m.toString(16).length)}${t.m.toString(16)}`,red:t.M,green:t.g,blue:t.p,area:t.i/s,hue:t.C,saturation:t.v,lightness:t.j,intensity:t.D}))(t,s)))},u=(t,s={})=>{const[e,r,i,o,a,u]=n(s),{N:l,count:d}=h(t,e,r,i);return c(l,d,o,a,u)},l=(t,s={})=>{if(a()){const[e,r,i,o,a,u,l]=n(s);return t.crossOrigin=l,new Promise((s=>{const n=t=>{const n=((t,s)=>{const e=t.width*t.height,r=e<s?t.width:Math.round(t.width*Math.sqrt(s/e)),n=e<s?t.height:Math.round(t.height*Math.sqrt(s/e)),i=document.createElement("canvas");i.width=r,i.height=n;const o=i.getContext("2d");return o.drawImage(t,0,0,t.width,t.height,0,0,r,n),o.getImageData(0,0,r,n)})(t,e),{N:l,count:d}=h(n,e,r,i);s(c(l,d,o,a,u))};if(t.complete)n(t);else{const s=()=>{t.removeEventListener("load",s),n(t)};t.addEventListener("load",s)}}))}if("production"!==process.env.NODE_ENV)throw new Error("Can not use extractColorsFromImage for Node.js")},d=(t,s={})=>{if(a()){const e=new Image;return e.src=t,l(e,s)}if("production"!==process.env.NODE_ENV)throw new Error("Can not use extractColorsFromSrc for Node.js")};exports.extractColors=(t,s)=>{if(!a()){if("production"!==process.env.NODE_ENV){if(t instanceof String)throw new Error("Send imageData to extractColors (Image src or HTMLImageElement not supported in Nodejs)");if(!t.data)throw new Error("Send imageData to extractColors");(null==s?void 0:s.crossOrigin)&&console.warn("options.crossOrigin not supported in Node.js")}return new Promise((e=>{e(u(t,s))}))}if(t instanceof Image)return l(t,s);if(t instanceof ImageData||t instanceof Object&&t.data)return new Promise((e=>{e(u(t,s))}));if("string"==typeof t)return d(t,s);throw new Error("Can not analyse picture")},exports.extractColorsFromImage=l,exports.extractColorsFromImageData=u,exports.extractColorsFromSrc=d;
//# sourceMappingURL=extract-colors.cjs.map
